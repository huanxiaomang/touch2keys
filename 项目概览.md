# Touch2Keys 项目概览

## 🎯 项目简介

Touch2Keys 是一个将手机触摸屏转换为节奏游戏键盘输入的 Web 应用，已完成全面工程化改造。

## 📦 技术栈

### 前端
- **框架**: Vue 3.5.28 (Composition API)
- **语言**: TypeScript 5.9.3
- **构建**: Vite 8.0.0-beta.13
- **样式**: Tailwind CSS 4.1.18
- **通信**: Socket.IO Client 4.8.3
- **包管理**: pnpm

### 后端
- **框架**: Flask 3.0.0
- **实时通信**: Flask-SocketIO 5.3.6
- **键盘模拟**: pydirectinput 1.0.4
- **异步**: eventlet 0.35.2
- **打包**: PyInstaller

## 🚀 快速开始

### 开发环境

```bash
# 一键启动（推荐）
./dev.sh        # macOS/Linux
dev.bat         # Windows
```

访问：
- 前端开发服务器: http://localhost:5173
- 后端 API: http://localhost:5000

### 生产打包

```bash
# 一键打包成 exe
./build.sh      # macOS/Linux
build.bat       # Windows
```

输出：`dist/Touch2Keys.exe` (Windows) 或 `dist/Touch2Keys` (macOS/Linux)

## 📁 项目结构

```
touch2keys/
├── 📱 frontend/              前端项目 (Vue3 + TS + Tailwind)
│   ├── src/                 源代码
│   ├── scripts/             构建脚本
│   ├── package.json         前端依赖
│   ├── vite.config.ts       Vite 配置
│   └── tsconfig.json        TypeScript 配置
│
├── 🐍 server.py             Flask 后端服务器
├── 📋 requirements.txt      Python 依赖
├── ⚙️  touch2keys.spec       PyInstaller 配置
│
├── 🔨 build.sh/bat          打包脚本
├── 🔧 dev.sh/bat            开发脚本
│
├── 📦 static/               静态资源（构建输出）
├── 📄 templates/            HTML 模板（构建输出）
│
└── 📚 文档/
    ├── README.md            项目介绍
    ├── BUILD.md             构建指南
    ├── USAGE.md             使用说明
    ├── QUICKSTART.md        快速开始
    ├── CHANGELOG.md         更新日志
    └── 工程化总结.md         工程化总结
```

## 🎮 游戏模式

| 模式 | 按键数 | 布局 | 说明 |
|------|--------|------|------|
| **Rizline** | 26 键 | 9 区域横向 | 智能按键分配，支持多点触控 |
| **Muse Dash** | 6 键 | 左右分屏 | d/f/s (左) + j/k/l (右) |
| **OSU** | 4 键 | 网格布局 | d/f/j/k 固定映射 |

## 🛠️ 常用命令

### 开发
```bash
./dev.sh                          # 一键启动开发环境
python server.py                  # 仅启动后端
cd frontend && pnpm run dev       # 仅启动前端
```

### 构建
```bash
./build.sh                        # 完整打包
cd frontend && pnpm run build:prod  # 仅构建前端
```

### 依赖管理
```bash
pip install -r requirements.txt   # 安装 Python 依赖
cd frontend && pnpm install       # 安装前端依赖
pnpm install:all                  # 安装所有依赖（根目录）
```

## 🔄 工作流程

### 开发流程
1. 运行 `./dev.sh` 启动开发环境
2. 前端修改自动热重载
3. 后端修改需重启 `server.py`

### 构建流程
1. 前端构建 → `dist/`
2. 复制到 `static/` 和 `templates/`
3. PyInstaller 打包 → `dist/Touch2Keys.exe`

### 部署流程
1. 运行 `./build.sh` 打包
2. 分发 `dist/Touch2Keys.exe`
3. 用户直接运行，无需安装依赖

## 📱 使用方式

### 连接手机

**方式 1: 局域网**
```bash
# 查看电脑 IP
ipconfig        # Windows
ifconfig        # macOS/Linux

# 手机浏览器访问
http://<电脑IP>:5000
```

**方式 2: USB (Android)**
```bash
adb reverse tcp:5000 tcp:5000
# 手机访问 http://localhost:5000
```

### 操作说明
1. 选择游戏模式（顶部按钮）
2. 触摸屏幕触发按键
3. 多点触控支持
4. 底部功能键（ESC/Enter/Backspace/Delete）

## 🎨 特色功能

- ✅ **低延迟**: WebSocket 实时通信，~5ms 键盘延迟
- ✅ **多点触控**: 支持同时按下多个按键
- ✅ **可视化反馈**: 触摸点实时显示
- ✅ **智能分配**: Rizline 模式智能按键分配
- ✅ **热重载**: 开发环境自动刷新
- ✅ **类型安全**: TypeScript 全栈类型检查
- ✅ **一键打包**: 自动化构建流程

## 📊 性能指标

- **前端构建时间**: ~1s (Vite)
- **完整打包时间**: ~30s
- **exe 文件大小**: ~50MB (包含所有依赖)
- **键盘延迟**: ~5ms (pydirectinput)
- **WebSocket 延迟**: <10ms (局域网)

## 🔧 配置选项

### 调试模式
编辑 `server.py`:
```python
DEBUG = True  # 启用详细日志
```

### 端口配置
编辑 `server.py`:
```python
socketio.run(app, host='0.0.0.0', port=5000)
```

### 前端代理
编辑 `frontend/vite.config.ts`:
```typescript
server: {
  proxy: {
    '/socket.io': {
      target: 'http://localhost:5000',
    },
  },
}
```

## 📚 文档导航

- 🚀 [快速开始](QUICKSTART.md) - 5 分钟上手
- 📖 [完整文档](README.md) - 项目介绍
- 🔨 [构建指南](BUILD.md) - 详细构建说明
- 📱 [使用说明](USAGE.md) - 使用教程
- 📝 [更新日志](CHANGELOG.md) - 版本历史
- 🏗️ [工程化总结](工程化总结.md) - 技术细节

## 🤝 贡献指南

1. Fork 项目
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启 Pull Request

## 📄 许可证

MIT License

---

**开发者**: Touch2Keys Team  
**版本**: 1.0.0  
**最后更新**: 2026-02-10

